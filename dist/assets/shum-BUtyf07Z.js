import"./metrika-BY1HYfmI.js";import"./discount-popup-C8REf4fq.js";document.addEventListener("DOMContentLoaded",function(){if(document.querySelector(".soundproofing-zones")){let c=function(g){a&&g!==o&&(a.style.opacity="0.8",setTimeout(()=>{a.src=g,a.style.opacity="1",o=g},150))},l=function(){a&&o!=="img/shum-preview.png"&&c("img/shum-preview.png")};const a=document.getElementById("zonesMainImage"),r=document.querySelectorAll(".zone-btn");let o="img/shum-preview.png";r.forEach(g=>{const u=g.getAttribute("data-image");u&&g.addEventListener("click",function(){const d=this.classList.contains("active");r.forEach(h=>h.classList.remove("active")),d?l():(this.classList.add("active"),c(u))})}),a&&(a.src=o)}});document.addEventListener("DOMContentLoaded",function(){const a=document.querySelector(".shum-form__form"),r=document.querySelector(".shum-form__submit"),o=document.getElementById("shumFormName"),c=document.getElementById("shumFormPhone"),l=document.getElementById("shumFormCar"),g=document.getElementById("shumFormNameError"),u=document.getElementById("shumFormPhoneError"),d=document.getElementById("shumFormCarError"),h=document.querySelectorAll(".additional-option"),f=document.getElementById("shumDiscountSection"),S=document.getElementById("shumDiscountPercent");let I="shum",m=[],E=0;const x={"antigravity-film":5e4,"disk-painting":3e4,cleaning:15e3,ceramic:25e3,polish:1e4};function B(){return o.value.trim().length<2?(C(g,"Имя должно содержать минимум 2 символа"),!1):(M(g),!0)}function b(){const n=c.value.trim();return/^[\+]?[0-9\s\-\(\)]{10,}$/.test(n)?(M(u),!0):(C(u,"Введите корректный номер телефона"),!1)}function L(){return l.value.trim().length<3?(C(d,"Укажите марку и модель автомобиля"),!1):(M(d),!0)}function C(n,t){n&&(n.textContent=t,n.classList.add("active"))}function M(n){n&&(n.textContent="",n.classList.remove("active"))}function y(){const n=o.value.trim().length>=2,t=/^[\+]?[0-9\s\-\(\)]{10,}$/.test(c.value.trim()),e=l.value.trim().length>=3,s=I!=="";r.disabled=!(n&&t&&e&&s)}function _(){if(m.length===0){E=0,f.style.display="none";return}const t=Math.min([0,2,4,8,12,16,20][m.length]||20,20);let e=0;m.forEach(i=>{e+=x[i]||0});const s=Math.floor(e/1e4)*.5;E=Math.min(t+s,20),S.textContent=`-${Math.round(E)}%`,f.style.display="block"}o&&(o.addEventListener("input",function(){B(),y()}),o.addEventListener("blur",B)),c&&(c.addEventListener("input",function(n){let t=n.target.value.replace(/\D/g,"");t.length>11&&(t=t.slice(0,11)),t.length>=6?t=t.replace(/(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})/,"+$1 ($2) $3-$4-$5"):t.length>=3?t=t.replace(/(\d{1})(\d{3})/,"+$1 ($2"):t.length>=1&&(t="+"+t),n.target.value=t,b(),y()}),c.addEventListener("blur",b)),l&&(l.addEventListener("input",function(){L(),y()}),l.addEventListener("blur",L)),h.forEach(n=>{n.addEventListener("click",function(){const t=this.dataset.option;m.includes(t)?(m=m.filter(e=>e!==t),this.classList.remove("additional-option--selected")):(m.push(t),this.classList.add("additional-option--selected")),_()})}),a&&a.addEventListener("submit",function(n){n.preventDefault();const t=B(),e=b(),s=L();if(t&&e&&s&&I){r.textContent="Отправляем...",r.disabled=!0;const i={name:o.value,phone:c.value,carModel:l.value,mainService:I,additionalServices:m,discount:Math.round(E),source:"WEBSITE"};fetch("/api/requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(p=>{if(p.ok){const v=document.getElementById("successPopupOverlay");v?v.classList.add("active"):alert("Спасибо за заявку! Мы свяжемся с вами в течение 15 минут.");const G=document.getElementById("successPopupClose"),A=document.getElementById("discountSuccessBtn"),T=()=>{v&&v.classList.remove("active")};G&&(G.onclick=T),A&&(A.onclick=T),a.reset(),h.forEach(P=>P.classList.remove("additional-option--selected")),I="shum",m=[],E=0,f&&(f.style.display="none")}else throw new Error("Server error")}).catch(p=>{alert("Произошла ошибка при отправке. Пожалуйста, попробуйте позже или позвоните нам.")}).finally(()=>{r.textContent="Отправить заявку",y()})}}),y()});document.addEventListener("DOMContentLoaded",function(){const a=document.getElementById("shumThumbnails"),r=document.getElementById("mainShumImage"),o=document.getElementById("mainShumTitle"),c=document.getElementById("mainShumServices"),l=document.querySelector(".shum-results__nav-btn--prev"),g=document.querySelector(".shum-results__nav-btn--next"),u=[{id:0,title:"Mercedes GLC",images:["img/Gallery-1.png","img/Gallery-2.png","img/Gallery-3.png"],thumbnails:["img/Gallery-1.png","img/Gallery-2.png","img/Gallery-3.png"],alt:"Mercedes GLC - Шумоизоляция с арками",services:[{badge:"12 часов",text:"Время на работу"},{badge:"2 года",text:"Гарантия"},{badge:"88 000₽",text:"Стоимость"}]},{id:1,title:"BMW X5",images:["img/Gallery-2.png","img/Gallery-3.png","img/Gallery-1.png"],thumbnails:["img/Gallery-2.png","img/Gallery-3.png","img/Gallery-1.png"],alt:"BMW X5 - Полная шумоизоляция",services:[{badge:"16 часов",text:"Время на работу"},{badge:"3 года",text:"Гарантия"},{badge:"120 000₽",text:"Стоимость"}]},{id:2,title:"Audi A6",images:["img/Gallery-3.png","img/Gallery-1.png","img/Gallery-2.png"],thumbnails:["img/Gallery-3.png","img/Gallery-1.png","img/Gallery-2.png"],alt:"Audi A6 - Премиум шумоизоляция",services:[{badge:"14 часов",text:"Время на работу"},{badge:"2 года",text:"Гарантия"},{badge:"95 000₽",text:"Стоимость"}]}];let d=0,h=0,f=!0,S;function I(e){return a?(a.innerHTML="",e.thumbnails.forEach((s,i)=>{const p=document.createElement("div");p.className="shum-results__thumbnail",p.dataset.image=i;const v=document.createElement("img");v.src=s,v.alt=`${e.title} - вид ${i+1}`,v.loading="lazy",p.appendChild(v),a.appendChild(p),p.addEventListener("click",()=>{B(i),b()})}),document.querySelectorAll(".shum-results__thumbnail")):[]}function m(e,s=!0){const i=u[e];i&&(s&&(r.style.opacity="0"),setTimeout(()=>{r.src=i.images[h],r.alt=i.alt,o.textContent=i.title,E(i.services);const p=I(i);x(p),d=e,s&&(r.style.opacity="1")},s?150:0))}function E(e){c&&(c.innerHTML="",e.forEach(s=>{const i=document.createElement("div");i.className="shum-results__service-item",i.innerHTML=`
                <div class="shum-results__service-badge">${s.badge}</div>
                <div class="shum-results__service-text">${s.text}</div>
            `,c.appendChild(i)}))}function x(e){e.forEach((s,i)=>{i===h?s.classList.add("active"):s.classList.remove("active")})}function B(e){if(e<0||e>=u[d].images.length)return;h=e,r.src=u[d].images[h];const s=document.querySelectorAll(".shum-results__thumbnail");x(s)}function b(){f=!1,clearInterval(S),setTimeout(()=>{f=!0,L()},1e4)}function L(){S=setInterval(()=>{if(f){const e=d===u.length-1?0:d+1;h=0,m(e)}},8e3)}function C(){l&&l.addEventListener("click",()=>{const e=d===0?u.length-1:d-1;h=0,m(e),b()}),g&&g.addEventListener("click",()=>{const e=d===u.length-1?0:d+1;h=0,m(e),b()})}function M(){document.hidden?clearInterval(S):f&&L()}function y(){u.length!==0&&(C(),L(),document.addEventListener("visibilitychange",M),m(0,!1),_())}function _(){u.forEach(e=>{e.images.forEach(s=>{const i=new Image;i.src=s})})}function n(e){e.src="img/placeholder.png",e.alt="Изображение недоступно"}function t(){document.querySelectorAll("#mainShumImage, .shum-results__thumbnail img").forEach(s=>{s.addEventListener("error",function(){n(this)})})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y):y(),setTimeout(t,100)});document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".process-step").forEach(o=>{o.addEventListener("mouseenter",function(){this.classList.add("hovered")}),o.addEventListener("mouseleave",function(){this.classList.remove("hovered")})}),[{selector:".process-step:nth-child(1)",step:"01"},{selector:".process-step:nth-child(2)",step:"02"},{selector:".process-step:nth-child(3)",step:"03"},{selector:".process-step:nth-child(4)",step:"04"}].forEach(({selector:o,step:c})=>{const l=document.querySelector(o);l&&l.setAttribute("data-step",c)})});
