import"./metrika-BY1HYfmI.js";import"./discount-popup-C8REf4fq.js";const l=[{id:1,title:"Mercedes-Benz S-Class - Полный антихром",carBrand:"Mercedes-Benz",carModel:"S-Class W223",services:["Антихром","Шумоизоляция"],mainImage:"img/gallery-1.png",gallery:["img/gallery-1.png","img/gallery-2.png","img/gallery-3.png"],description:"Полная замена всех хромированных элементов на черные глянцевые + премиальная шумоизоляция салона. Результат - элегантный и современный вид автомобиля премиум-класса.",date:"2024-01-15",featured:!0,views:245},{id:2,title:"Mercedes-Benz GLE - Карбон и антихром",carBrand:"Mercedes-Benz",carModel:"GLE Coupe",services:["Карбон","Антихром"],mainImage:"img/portfolio/mercedes-gle-1.jpg",gallery:["img/portfolio/mercedes-gle-1.jpg","img/portfolio/mercedes-gle-2.jpg"],description:"Установка карбоновых элементов обвеса и замена хрома на черный глянец. Автомобиль получил спортивный и агрессивный характер.",date:"2024-01-12",featured:!0,views:189},{id:3,title:"Mercedes-Benz GLS Maybach - Премиум шумоизоляция",carBrand:"Mercedes-Benz",carModel:"GLS Maybach",services:["Шумоизоляция","Антихром"],mainImage:"img/portfolio/mercedes-gls-1.jpg",gallery:["img/portfolio/mercedes-gls-1.jpg","img/portfolio/mercedes-gls-2.jpg","img/portfolio/mercedes-gls-3.jpg"],description:"Премиальная шумоизоляция салона автомобиля Maybach. Использованы лучшие материалы для достижения максимального комфорта в поездках.",date:"2024-01-10",featured:!1,views:156},{id:4,title:"BMW X7 - Полный карбоновый обвес",carBrand:"BMW",carModel:"X7",services:["Карбон","Антихром"],mainImage:"img/portfolio/bmw-x7-1.jpg",gallery:["img/portfolio/bmw-x7-1.jpg","img/portfolio/bmw-x7-2.jpg","img/portfolio/bmw-x7-3.jpg"],description:"Установка полного карбонового обвеса M-Performance и замена всех хромированных элементов. Автомобиль стал настоящим спорткаром.",date:"2024-01-08",featured:!0,views:203},{id:5,title:"BMW M5 Competition - Спорт-карбон",carBrand:"BMW",carModel:"M5 Competition",services:["Карбон"],mainImage:"img/portfolio/bmw-m5-1.jpg",gallery:["img/portfolio/bmw-m5-1.jpg","img/portfolio/bmw-m5-2.jpg"],description:"Установка карбоновых элементов экстерьера для BMW M5 Competition. Подчеркнуты спортивные характеристики автомобиля.",date:"2024-01-05",featured:!1,views:167},{id:6,title:"Audi RS7 - Черный антихром",carBrand:"Audi",carModel:"RS7",services:["Антихром","Керамика"],mainImage:"img/portfolio/audi-rs7-1.jpg",gallery:["img/portfolio/audi-rs7-1.jpg","img/portfolio/audi-rs7-2.jpg","img/portfolio/audi-rs7-3.jpg"],description:"Полная замена хромированных элементов на черные матовые + нанесение керамического покрытия. Автомобиль получил агрессивный спортивный вид.",date:"2024-01-03",featured:!0,views:234},{id:7,title:"Porsche Cayenne Turbo GT - Премиум тюнинг",carBrand:"Porsche",carModel:"Cayenne Turbo GT",services:["Антихром","Карбон","Шумоизоляция"],mainImage:"img/portfolio/porsche-cayenne-1.jpg",gallery:["img/portfolio/porsche-cayenne-1.jpg","img/portfolio/porsche-cayenne-2.jpg"],description:"Комплексный тюнинг Porsche Cayenne: антихром, карбоновые элементы и премиальная шумоизоляция салона.",date:"2024-01-01",featured:!0,views:198},{id:8,title:"Lexus LX 600 - Вип шумоизоляция",carBrand:"Lexus",carModel:"LX 600",services:["Шумоизоляция","Антихром"],mainImage:"img/portfolio/lexus-lx-1.jpg",gallery:["img/portfolio/lexus-lx-1.jpg","img/portfolio/lexus-lx-2.jpg","img/portfolio/lexus-lx-3.jpg"],description:"Премиальная шумоизоляция салона Lexus LX 600 с использованием лучших материалов. Максимальный комфорт для пассажиров VIP-класса.",date:"2023-12-28",featured:!1,views:145},{id:9,title:"Range Rover Sport - Карбон и антихром",carBrand:"Land Rover",carModel:"Range Rover Sport",services:["Карбон","Антихром"],mainImage:"img/portfolio/range-rover-1.jpg",gallery:["img/portfolio/range-rover-1.jpg","img/portfolio/range-rover-2.jpg"],description:"Установка карбоновых элементов и замена хрома для Range Rover Sport. Автомобиль получил современный и стильный внешний вид.",date:"2023-12-25",featured:!1,views:123},{id:10,title:"Tesla Model S Plaid - Антихром",carBrand:"Tesla",carModel:"Model S Plaid",services:["Антихром"],mainImage:"img/portfolio/tesla-models-1.jpg",gallery:["img/portfolio/tesla-models-1.jpg","img/portfolio/tesla-models-2.jpg"],description:"Замена хромированных элементов на черные матовые для Tesla Model S Plaid. Электромобиль получил более агрессивный и современный вид.",date:"2023-12-20",featured:!1,views:178},{id:11,title:"BMW 7 Series - Шумоизоляция премиум",carBrand:"BMW",carModel:"7 Series",services:["Шумоизоляция"],mainImage:"img/portfolio/bmw-7-1.jpg",gallery:["img/portfolio/bmw-7-1.jpg","img/portfolio/bmw-7-2.jpg"],description:"Премиальная шумоизоляция салона BMW 7 Series. Использованы лучшие материалы для достижения максимального комфорта.",date:"2023-12-18",featured:!1,views:134},{id:12,title:"Audi A8 - Полный карбон",carBrand:"Audi",carModel:"A8",services:["Карбон"],mainImage:"img/portfolio/audi-a8-1.jpg",gallery:["img/portfolio/audi-a8-1.jpg","img/portfolio/audi-a8-2.jpg","img/portfolio/audi-a8-3.jpg"],description:"Установка карбоновых элементов на Audi A8. Автомобиль получил спортивный характер и улучшенные аэродинамические характеристики.",date:"2023-12-15",featured:!1,views:156}];function g(){return[...new Set(l.map(e=>e.carBrand))].sort()}function u(){return[...new Set(l.flatMap(e=>e.services))].sort()}function f(){return l.filter(n=>n.featured).sort((n,e)=>new Date(e.date)-new Date(n.date)).slice(0,6)}function v(n){return l.find(e=>e.id===parseInt(n))}function h(n){const e=new Date(n),o=Math.abs(new Date-e),r=Math.ceil(o/(1e3*60*60*24));return r===1?"Сегодня":r===2?"Вчера":r<=7?`${r} дней назад`:e.toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})}window.PORTFOLIO_DATA=l;window.getAllCarBrands=g;window.getAllServices=u;window.getFeaturedPortfolio=f;window.getPortfolioById=v;window.formatPortfolioDate=h;function s(n){return{antichrome:"Антихром",soundproofing:"Шумоизоляция",ceramic:"Керамика",polish:"Полировка",carbon:"Карбон","antigravity-film":"Антигравийная пленка","disk-painting":"Колесные диски","detailing-wash":"Химчистка",Антихром:"Антихром",Шумоизоляция:"Шумоизоляция",Керамика:"Керамика",Карбон:"Карбон"}[n]||n}function c(n){if(!n)return"Дата не указана";const e=new Date(n);if(isNaN(e.getTime()))return"Дата не указана";const t=e.getDate(),o=e.getFullYear(),a=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][e.getMonth()];return`${t} ${a} ${o} г.`}class M{constructor(){this.portfolioData=[],this.filteredPortfolio=[],this.currentPage=1,this.itemsPerPage=12,this.currentBrand="all",this.currentService="all",this.currentSort="date",this.activeFilters=new Set,this.init()}init(){this.loadPortfolioData(),this.setupFilterOptions(),this.setupEventListeners(),this.renderPortfolio()}async loadPortfolioData(){try{const e=await fetch("/api/portfolio");if(!e.ok)throw new Error("Failed to fetch portfolio");const t=await e.json();this.portfolioData=t.map(o=>({id:o.id,title:o.title,carBrand:o.carBrand,carModel:o.carModel,mainImage:o.mainImage||null,gallery:o.gallery||[],services:o.services||[],date:o.date,description:o.description,views:o.views||0})),this.filteredPortfolio=[...this.portfolioData],this.setupFilterOptions(),this.renderPortfolio()}catch{}}setupFilterOptions(){const e=document.getElementById("brandMenu");if(e){const o=e.querySelector('[data-value="all"]');e.innerHTML="",o&&e.appendChild(o),[...new Set(this.portfolioData.map(a=>a.carBrand))].sort().forEach(a=>{const i=document.createElement("div");i.className="filter-dropdown__option",i.textContent=a,i.setAttribute("data-value",a),e.appendChild(i)})}const t=document.getElementById("serviceMenu");if(t){const o=t.querySelector('[data-value="all"]');t.innerHTML="",o&&t.appendChild(o),[...new Set(this.portfolioData.flatMap(a=>a.services))].sort().forEach(a=>{const i=document.createElement("div");i.className="filter-dropdown__option",i.textContent=s(a),i.setAttribute("data-value",a),t.appendChild(i)})}}setupEventListeners(){const e=document.getElementById("brandToggle"),t=document.getElementById("brandMenu");e&&t&&(e.addEventListener("click",i=>{i.stopPropagation(),this.closeAllDropdowns(),t.classList.toggle("active")}),t.addEventListener("click",i=>{i.target.classList.contains("filter-dropdown__option")&&(this.currentBrand=i.target.dataset.value,this.updateBrandText(i.target.textContent),this.updateActiveFilters(),t.classList.remove("active"),this.applyFilters())}));const o=document.getElementById("serviceToggle"),r=document.getElementById("serviceMenu");o&&r&&(o.addEventListener("click",i=>{i.stopPropagation(),this.closeAllDropdowns(),r.classList.toggle("active")}),r.addEventListener("click",i=>{const d=i.target.closest(".filter-dropdown__option");if(!d)return;const m=d.dataset.value,p=d.textContent;this.currentService=m,this.updateServiceText(p),this.updateActiveFilters(),r.classList.remove("active"),this.applyFilters()}));const a=document.getElementById("showMoreBtn");a&&a.addEventListener("click",()=>{this.loadMorePortfolio()}),this.setupModalEvents(),document.addEventListener("click",i=>{i.target.closest(".filter-dropdown")||this.closeAllDropdowns()})}updateBrandText(e){const t=document.getElementById("brandToggle");if(t){const o=t.querySelector(".filter-dropdown__text");o&&(o.textContent=e)}}updateServiceText(e){const t=document.getElementById("serviceToggle");if(t){const o=t.querySelector(".filter-dropdown__text");o&&(o.textContent=e)}}updateSortText(e){const t=document.getElementById("sortToggle");if(t){const o=t.querySelector(".filter-dropdown__text");o&&(o.textContent=e)}}updateActiveFilters(){const e=document.getElementById("activeFilters");e&&(e.innerHTML="",this.currentBrand!=="all"&&this.addActiveFilter("brand",this.currentBrand,this.getBrandDisplayName(this.currentBrand)),this.currentService!=="all"&&this.addActiveFilter("service",this.currentService,s(this.currentService)),e.style.display=this.activeFilters.size>0?"block":"none")}addActiveFilter(e,t,o){const r=document.createElement("div");r.className="active-filter",r.innerHTML=`
            <span>${o}</span>
            <button class="active-filter__remove" data-type="${e}" data-value="${t}">×</button>
        `,r.querySelector(".active-filter__remove").addEventListener("click",()=>{this.removeFilter(e,t)});const i=document.getElementById("activeFilters");i&&i.appendChild(r),this.activeFilters.add(`${e}:${t}`)}removeFilter(e,t){e==="brand"?(this.currentBrand="all",this.updateBrandText("Все марки")):e==="service"&&(this.currentService="all",this.updateServiceText("Все услуги")),this.activeFilters.delete(`${e}:${t}`),this.applyFilters()}getBrandDisplayName(e){return{"Mercedes-Benz":"Mercedes-Benz",BMW:"BMW",Audi:"Audi",Porsche:"Porsche",Lexus:"Lexus","Land Rover":"Land Rover",Tesla:"Tesla"}[e]||e}closeAllDropdowns(){document.querySelectorAll(".filter-dropdown__menu.active").forEach(e=>{e.classList.remove("active")})}applyFilters(){this.currentPage=1;let e=this.portfolioData;this.currentBrand!=="all"&&(e=e.filter(t=>t.carBrand===this.currentBrand)),this.currentService!=="all"&&(e=e.filter(t=>Array.isArray(t.services)&&t.services.includes(this.currentService))),this.sortPortfolio(e),this.updateActiveFilters(),this.renderPortfolio()}sortPortfolio(e){const t=[...e];t.sort((o,r)=>{switch(this.currentSort){case"date":return new Date(r.date)-new Date(o.date);case"popular":return r.views-o.views;case"title":return o.title.localeCompare(r.title);default:return 0}}),this.filteredPortfolio=t}renderPortfolio(){const e=document.getElementById("portfolioGrid");if(!e)return;const t=0,o=this.currentPage*this.itemsPerPage,r=this.filteredPortfolio.slice(t,o);if(e.innerHTML="",r.length===0){e.innerHTML='<div class="no-portfolio">Работы не найдены</div>',this.updateShowMoreButton(!1);return}r.forEach(a=>{const i=this.createPortfolioCard(a);e.appendChild(i)}),this.updateShowMoreButton(o<this.filteredPortfolio.length)}createPortfolioCard(e){const t=document.createElement("div");t.className="portfolio-card",t.setAttribute("data-id",e.id);const o=`
            <div class="portfolio-card__image">
                <img src="${e.mainImage}" alt="${e.title}">
            </div>
            <div class="portfolio-card__content">
                <h3 class="portfolio-card__title">${e.title}</h3>
                <div class="portfolio-card__car">${e.carBrand} ${e.carModel}</div>
                <div class="portfolio-card__services">
                    ${e.services.map(r=>`<span class="portfolio-card__service">${s(r)}</span>`).join("")}
                </div>
                <div class="portfolio-card__date">${c(e.date)}</div>
            </div>
        `;return t.innerHTML=o,t.addEventListener("click",()=>{this.openPortfolioModal(e.id)}),t}updateShowMoreButton(e){const t=document.getElementById("showMoreBtn");t&&(t.style.display=e?"flex":"none")}loadMorePortfolio(){this.currentPage++,this.renderPortfolio()}setupModalEvents(){const e=document.getElementById("portfolioModal"),t=document.getElementById("modalClose");t&&t.addEventListener("click",()=>{this.closePortfolioModal()}),e&&e.addEventListener("click",o=>{o.target===e&&this.closePortfolioModal()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&e&&e.classList.contains("active")&&this.closePortfolioModal()})}openPortfolioModal(e){const t=this.portfolioData.find(a=>a.id===e);if(!t)return;const o=document.getElementById("portfolioModal");if(!o)return;document.getElementById("modalMainImage").src=t.mainImage,document.getElementById("modalTitle").textContent=t.title,document.getElementById("modalBrand").textContent=`${t.carBrand} ${t.carModel}`,document.getElementById("modalDate").textContent=c(t.date),document.getElementById("modalDescription").textContent=t.description||"";const r=document.getElementById("modalServices");r.innerHTML="",t.services.forEach(a=>{const i=document.createElement("span");i.className="portfolio-modal__service-tag",i.textContent=s(a),r.appendChild(i)}),this.renderModalGallery(t),o.classList.add("active"),document.body.style.overflow="hidden"}renderModalGallery(e){const t=document.getElementById("modalThumbnails");t&&(t.innerHTML="",e.gallery.forEach((o,r)=>{const a=document.createElement("div");a.className=`portfolio-modal__thumbnail ${r===0?"portfolio-modal__thumbnail--active":""}`,a.innerHTML=`<img src="${o}" alt="Thumbnail ${r+1}">`,a.addEventListener("click",()=>{document.getElementById("modalMainImage").src=o,t.querySelectorAll(".portfolio-modal__thumbnail").forEach(i=>{i.classList.remove("portfolio-modal__thumbnail--active")}),a.classList.add("portfolio-modal__thumbnail--active")}),t.appendChild(a)}))}closePortfolioModal(){const e=document.getElementById("portfolioModal");e&&(e.classList.remove("active"),document.body.style.overflow="")}}document.addEventListener("DOMContentLoaded",()=>{new M});
